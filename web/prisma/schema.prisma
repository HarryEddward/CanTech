generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}


model Product {
  id          String   @id @default(cuid())
  name        String
  description String?
  price       Int
  image       String?
  stock       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  orders      Order[]
}

model Order {
  id             String   @id @default(cuid())
  stripePaymentId   String   @unique
  stripeCustomerId  String?  // el "perfil" de Stripe (sin ser usuario)
  productId         String
  amount            Int
  createdAt         DateTime @default(now())
  

  product Product @relation(fields: [productId], references: [id])
  qrToken DiscountToken?
}

model DiscountToken {
  id                String   @id @default(cuid())
  orderId           String   @unique
  token             String   @unique
  email             String?
  phone             String?
  stripeCustomerId  String?  // relaciona QR con el cliente de Stripe
  discount          Int      @default(10)
  used              Boolean  @default(false)
  createdAt         DateTime @default(now())

  order Order @relation(fields: [orderId], references: [id])
}
